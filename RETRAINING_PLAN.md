# LTC-NCP-VA 情感模型重训计划

## 1. 问题分析

当前模型存在的主要问题：

- **情感识别反转**：模型可能将负面情感判断为正面情感，反之亦然
- **CCC评分与实际效果不符**：模型在训练和验证集上CCC指标高，但实际情感判断效果差
- **区分度不足**：对不同类型的情感文本区分不明显
- **可能存在过拟合**：模型在特定数据集上表现好，但泛化能力差

## 2. 重训策略

### 2.1 数据层面

1. **重新审核训练数据**：
   - 检查标注一致性，确保VA值与情感标签一致
   - 筛选出标注可能有误的样本
   - 增加每种情感类型的样本多样性

2. **数据平衡与增强**：
   - 确保各情感象限数据均衡
   - 针对低频情感增加样本
   - 考虑使用轻度数据增强（如同义词替换）

3. **数据集分割优化**：
   - 使用分层采样确保训练/验证/测试集情感分布一致
   - 增加测试集比例，确保评估更全面

### 2.2 模型层面

1. **模型架构调整**：
   - 简化LTC复杂度，减少过拟合风险
   - 重新设计价效度分支，考虑增加情感先验知识
   - 优化特征融合机制

2. **引入对比学习**：
   - 采用对比学习框架，提高相似情感的相似度
   - 使用锚点样本增强极性区分

3. **多任务学习**：
   - 在VA回归的同时增加情感分类任务
   - 考虑词性/句法辅助任务增强文本理解

### 2.3 训练策略

1. **损失函数优化**：
   - 替换单纯的MSE/RMSE，引入CCC+MSE混合损失
   - 考虑增加对抗损失增强区分度
   - 使用焦点损失重点关注困难样本

2. **学习率策略**：
   - 采用warmup+cosine decay学习率
   - 不同层设置不同学习率（embedding层较低）

3. **正则化增强**：
   - 增加dropout比例
   - 考虑权重衰减和梯度裁剪
   - 使用早停策略防止过拟合

4. **分阶段训练**：
   - 第一阶段：在大型语料上预训练
   - 第二阶段：在情感语料上精调
   - 第三阶段：针对特定情感微调

## 3. 评估与监控

1. **多维度评估**：
   - 结合CCC、RMSE、Spearman相关系数等多项指标
   - 引入情感分类准确率、F1分数评估
   - 考虑人工评估部分样本

2. **交叉验证**：
   - 使用K折交叉验证确保模型稳定性
   - 对超参数进行网格搜索优化

3. **可视化**：
   - 使用t-SNE可视化情感嵌入空间
   - 绘制各情感象限的混淆矩阵
   - 跟踪训练过程中的梯度和权重变化

## 4. 实现路线图

### 阶段一：数据准备（1-2周）
- 重新审核和清洗训练数据
- 实现数据增强和平衡策略
- 建立更科学的数据集分割

### 阶段二：模型设计（1-2周）
- 简化现有LTC-NCP架构
- 添加对比学习和多任务模块
- 设计新的损失函数

### 阶段三：训练与优化（2-3周）
- 执行分阶段训练计划
- 超参数调优
- 基于多指标监控训练进展

### 阶段四：评估与改进（1-2周）
- 全面评估模型性能
- 分析错误案例
- 进行必要的模型调整

## 5. 技术实现注意点

1. **词汇表重建**：
   - 考虑基于更大语料重建词汇表
   - 增加情感词汇覆盖率

2. **计算效率**：
   - 优化LTC单元计算效率
   - 考虑混合精度训练加速

3. **代码重构**：
   - 模块化训练流程
   - 增强日志和可视化
   - 增加检查点保存频率

## 6. 潜在挑战与解决方案

1. **数据质量问题**：
   - 使用主动学习识别异常标注
   - 考虑引入众包重新标注部分数据

2. **过拟合风险**：
   - 实施渐进式学习率衰减
   - 动态调整batch size
   - 使用学习率热重启

3. **表达能力与泛化平衡**：
   - 使用模型蒸馏减小模型大小
   - 考虑模型集成提高稳定性 